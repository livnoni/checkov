resource "azurerm_virtual_machine" "virtual_machine_good_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "049a1691-aabf-4858-a599-e9daa2422ad2"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_1" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "621e33be-6023-42c2-a0bb-916e9c2cb1eb"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_2" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "660b19a7-b9ff-46c6-b1da-ae6f8eaa3935"
  }
}

resource "azurerm_virtual_machine" "virtual_machine_bad_3" {
  name                  = "acctvm"
  location              = "location"
  resource_group_name   = "group"
  network_interface_ids = ["id"]
  vm_size               = "Standard_F2"
  storage_os_disk {
    name          = "myosdisk1"
    caching       = "ReadWrite"
    create_option = "FromImage"
  }
  tags = {
    yor_trace = "7bfb05b9-203b-42b7-8bc3-a58b36a8cb83"
  }
}

resource "azurerm_virtual_machine_extension" "extension_good_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_good_1.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "50384f1a-72d2-4cdc-b1f1-c7b2469f67d8"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_1" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_1.id
  publisher                  = "Microsoft.Azure.Extensions"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "ad5c59b3-967c-49d0-afce-57dfc660c1c2"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_2" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_2.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "IaaSAntimalware"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = false
  tags = {
    yor_trace = "04500898-bd9e-421e-a756-f92fe691cf71"
  }
}

resource "azurerm_virtual_machine_extension" "extension_bad_3" {
  name                       = "hostname"
  virtual_machine_id         = azurerm_virtual_machine.virtual_machine_bad_3.id
  publisher                  = "Microsoft.Azure.Security"
  type                       = "CustomScript"
  type_handler_version       = "2.0"
  auto_upgrade_minor_version = true
  tags = {
    yor_trace = "363e6243-0018-40f2-8943-cdd219dac785"
  }
}