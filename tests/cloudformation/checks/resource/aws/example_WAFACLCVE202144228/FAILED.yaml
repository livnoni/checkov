AWSTemplateFormatVersion: '2010-09-09'
Resources:
  NoRule:
    Type: AWS::WAFv2::WebACL
    Properties:
      Name: 'example-webacl'
      DefaultAction:
        Allow: { }
      Scope: REGIONAL
      VisibilityConfig:
        SampledRequestsEnabled: false
        MetricName: ExampleWebACLMetric
        CloudWatchMetricsEnabled: false
      Tags:
        - Key: yor_trace
          Value: ba151e5f-32cd-4338-9a4f-53dec3483c71
  WrongRule:
    Type: AWS::WAFv2::WebACL
    Properties:
      Name: 'example-webacl'
      DefaultAction:
        Allow: { }
      Scope: REGIONAL
      VisibilityConfig:
        SampledRequestsEnabled: false
        MetricName: ExampleWebACLMetric
        CloudWatchMetricsEnabled: false
      Rules:
        - Name: rule-1
          Priority: 1
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesAnonymousIpList
          OverrideAction:
            None: { }
          VisibilityConfig:
            CloudWatchMetricsEnabled: false
            MetricName: AWSManagedRulesKnownBadInputsRuleSet
            SampledRequestsEnabled: false
      Tags:
        - Key: yor_trace
          Value: be2f319e-cf40-4e36-a66e-24a6444241dd
  RuleCount:
    Type: AWS::WAFv2::WebACL
    Properties:
      Name: 'example-webacl'
      DefaultAction:
        Allow: { }
      Scope: REGIONAL
      VisibilityConfig:
        SampledRequestsEnabled: false
        MetricName: ExampleWebACLMetric
        CloudWatchMetricsEnabled: false
      Rules:
        - Name: rule-1
          Priority: 1
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesKnownBadInputsRuleSet
              ExcludedRules:
                - Name: Log4JRCE
          OverrideAction:
            None: { }
          VisibilityConfig:
            CloudWatchMetricsEnabled: false
            MetricName: AWSManagedRulesKnownBadInputsRuleSet
            SampledRequestsEnabled: false
      Tags:
        - Key: yor_trace
          Value: ad5501df-9b45-4b11-8463-a87679322f82
  RuleGroupCount:
    Type: AWS::WAFv2::WebACL
    Properties:
      Name: 'example-webacl'
      DefaultAction:
        Allow: { }
      Scope: REGIONAL
      VisibilityConfig:
        SampledRequestsEnabled: false
        MetricName: ExampleWebACLMetric
        CloudWatchMetricsEnabled: false
      Rules:
        - Name: rule-1
          Priority: 1
          Statement:
            ManagedRuleGroupStatement:
              VendorName: AWS
              Name: AWSManagedRulesKnownBadInputsRuleSet
          OverrideAction:
            Count: { }
          VisibilityConfig:
            CloudWatchMetricsEnabled: false
            MetricName: AWSManagedRulesKnownBadInputsRuleSet
            SampledRequestsEnabled: false
      Tags:
        - Key: yor_trace
          Value: 65284baf-b54d-4bf9-9e96-acecda8069df
